from jinja2.runtime import LoopContext, Macro, Markup, Namespace, TemplateNotFound, TemplateReference, TemplateRuntimeError, Undefined, escape, identity, internalcode, markup_join, missing, str_join
name = 'tmpl_2003b5970eeebe48130ba97b0e085065d9ad3731.py'

def root(context, missing=missing):
    resolve = context.resolve_or_missing
    undefined = environment.undefined
    concat = environment.concat
    cond_expr_undefined = Undefined
    if 0: yield None
    pass
    yield 'from jinja2.runtime import LoopContext, Macro, Markup, Namespace, TemplateNotFound, TemplateReference, TemplateRuntimeError, Undefined, escape, identity, internalcode, markup_join, missing, str_join\nname = \'index_old.html\'\n\ndef root(context, missing=missing):\n    resolve = context.resolve_or_missing\n    undefined = environment.undefined\n    concat = environment.concat\n    cond_expr_undefined = Undefined\n    if 0: yield None\n    pass\n    yield \'<!DOCTYPE html>\\n<html lang="it">\\n<head>\\n    <meta charset="UTF-8">\\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\\n    <title>ES Gamma Analyzer - 0DTE</title>\\n    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">\\n    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">\\n    <style>\\n        * {\\n            margin: 0;\\n            padding: 0;\\n            box-sizing: border-box;\\n        }\\n        \\n        body {\\n            font-family: -apple-system, BlinkMacSystemFont, \\\'Segoe UI\\\', \\\'Roboto\\\', \\\'Helvetica\\\', \\\'Arial\\\', sans-serif;\\n            background: #0a0e27;\\n            min-height: 100vh;\\n            padding: 20px;\\n            color: #e0e6ed;\\n        }\\n        \\n        .container {\\n            max-width: 1200px;\\n            margin: 0 auto;\\n        }\\n        \\n        .header {\\n            text-align: center;\\n            color: #e0e6ed;\\n            margin-bottom: 30px;\\n            padding: 20px;\\n            background: linear-gradient(135deg, #1e2139 0%, #252a49 100%);\\n            border-radius: 15px;\\n            border: 1px solid #2d3250;\\n        }\\n        \\n        .header h1 {\\n            font-size: 2.5em;\\n            margin-bottom: 10px;\\n            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);\\n            -webkit-background-clip: text;\\n            -webkit-text-fill-color: transparent;\\n            background-clip: text;\\n        }#1a1f37;\\n            border-radius: 15px;\\n            padding: 30px;\\n            box-shadow: 0 4px 20px rgba(0,0,0,0.3);\\n            margin-bottom: 30px;\\n            border: 1px solid #2d3250;\\n        }\\n        \\n        .upload-area {\\n            border: 2px dashed #3b82f6;\\n            border-radius: 10px;\\n            padding: 40px;\\n            text-align: center;\\n            cursor: pointer;\\n            transition: all 0.3s;\\n            background: rgba(59, 130, 246, 0.05);\\n        }\\n        \\n        .upload-area:hover {\\n            background: rgba(59, 130, 246, 0.1);\\n            border-color: #60a5fa;\\n        }\\n        \\n        .upload-area.dragover {\\n            background: rgba(59, 130, 246, 0.15);\\n            border-color: #3b82f6\\n        \\n        .upload-area:hover {\\n            background: #f8f9ff;\\n            border-color: #764ba2;\\n        }\\n        \\n        .upload-area3b82f6;\\n            margin-bottom: 20px;\\n        }\\n        \\n        .upload-area h3 {\\n            color: #e0e6ed;\\n            margin-bottom: 10px;\\n        }\\n        \\n        .upload-area p {\\n            color: #9ca3af;\\n            border-color: #667eea;\\n        }\\n        600;\\n            color: #e0e6ed;\\n        }\\n        \\n        .price-input input {\\n            padding: 10px 15px;\\n            border: 1px solid #2d3250;\\n            border-radius: 8px;\\n            font-size: 1em;\\n            width: 150px;\\n            background: #0f1729;\\n            color: #e0e6ed;\\n            transition: border-color 0.3s;\\n        }3b82f6 0%, #8b5cf6 100%);\\n            color: white;\\n            border: none;\\n            padding: 14px 50px;\\n            font-size: 1.1em;\\n            font-weight: 600;\\n            border-radius: 10px;\\n            cursor: pointer;\\n            margin-top: 20px;\\n            transition: all 0.3s;\\n            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);\\n        }\\n        \\n        .analyze-btn:hover {\\n            transform: translateY(-2px);\\n            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4\\n        \\n        .price-input label {\\n            font-weight: bold;\\n            color: #333;\\n        }\\n        \\n        .price-input input {\\n            padding: 10px 15px;\\n            border: 2px solid #ddd;\\n            border-radius: 5px;\\n            font-size: 1em;\\n            width: 150px;2d3250;\\n            border-top: 4px solid #3b82f6;\\n            border-radius: 50%;\\n            width: 40px;\\n            height: 40px;\\n            animation: spin 1s linear infinite;\\n            margin: 0 auto;\\n        }\\n        \\n        .loading p {\\n            color: #3b82f6\\n            padding: 12px 40px;\\n            font-size: 1.1em;\\n            border-radius: 25px;\\n            cursor: pointer;\\n            margin-top: 20px;\\n            transition: transform 0.2s;\\n        }\\n        \\n        .analyze-btn:hov#1a1f37;\\n            border-radius: 12px;\\n            padding: 25px;\\n            margin-bottom: 20px;\\n            box-shadow: 0 4px 20px rgba(0,0,0,0.2);\\n            border: 1px solid #2d3250;\\n        }\\n        \\n        .card h2 {\\n            color: #e0e6ed;\\n            margin-bottom: 15px;\\n            font-size: 1.5em;\\n            border-bottom: 2px solid #3b82f6;\\n            padding-bottom: 10px;\\n        }\\n        \\n        .card h3 {\\n            color: #e0e6ed\\n        }\\n        \\n        .spinner {\\n            border: 4px solid #f3f3f3;\\n            border-top: 4px solid #667eea;\\n            border-radiurgba(59, 130, 246, 0.05);\\n            border-radius: 10px;\\n            border-left: 4px solid #3b82f6;\\n        }\\n        \\n        .info-label {\\n            font-size: 0.9em;\\n            color: #9ca3af;\\n            margin-bottom: 5px;\\n        }\\n        \\n        .info-value {\\n            font-size: 1.5em;\\n            font-weight: bold;\\n            color: #e0e6ed\\n        \\n        .card {\\n            background: white;\\n            border-radius: 15px;\\n            padding: 25px;\\n            margin-bottom: 20px;\\n            box-shadow: 0 5px 15px rgba(0,0,0,0.1);\\n        }\\n        \\n        .card h2 {\\n            color: #333;\\n            margin-bottom: 15px;\\n            font-size: 1.5em;1e3a8a 0%, #5b21b6 100%);\\n            color: white;\\n            text-align: center;\\n            padding: 25px;\\n            border-radius: 12px;\\n            margin-bottom: 20px;\\n            border: 1px solid rgba(59, 130, 246, 0.3);\\n            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.2);\\n        }\\n        \\n        .gamma-flip .value {\\n            font-size: 2.8em;\\n            font-weight: bold;\\n            text-shadow: 0 2px 10px rgba(0,0,0,0.3)\\n        .info-item {rgba(234, 179, 8, 0.1);\\n            border-left: 4px solid #eab308;\\n            padding: 15px;\\n            border-radius: 8px;\\n            margin-top: 15px;\\n            border: 1px solid rgba(234, 179, 8, 0.2);\\n        }\\n        \\n        .regime-box div {\\n            color: #e0e6ed solid #667eea;\\n        }\\n        \\n        .info-label {\\n            font-size: 0.9em;\\n            color: #666;rgba(59, 130, 246, 0.1);\\n            color: #e0e6ed;\\n            padding: 12px;\\n            text-align: left;\\n            font-weight: 600;\\n            border-bottom: 1px solid #2d3250;\\n        }\\n        \\n        .table td {\\n            padding: 12px;\\n            border-bottom: 1px solid #2d3250;\\n            color: #e0e6ed;\\n        }\\n        \\n        .table tr:hover {\\n            background: rgba(59, 130, 246, 0.05)\\n            padding: 20px;\\n            border-r10b981;\\n            font-weight: bold;\\n        }\\n        \\n        .resistance {\\n            color: #ef4444;\\n            font-weight: bold;\\n        }\\n        \\n        .level-item {\\n            background: rgba(15, 23, 42, 0.6);\\n            border-radius: 10px;\\n            padding: 15px 18px;\\n            margin-bottom: 12px;\\n            border-left: 4px solid;\\n            transition: all 0.3s;\\n            border: 1px solid;\\n        }\\n        \\n        .level-item:hover {\\n            transform: translateX(5px);\\n            box-shadow: 0 4px 15px rgba(0,0,0,0.3);\\n        }\\n        \\n        .level-item.support-item {\\n            border-left-color: #10b981;\\n            border-color: rgba(16, 185, 129, 0.2);\\n            background: rgba(16, 185, 129, 0.05);\\n        }\\n        \\n        .level-item.resistance-item {\\n            border-left-color: #ef4444;\\n            border-color: rgba(239, 68, 68, 0.2);\\n            background: rgba(239, 68, 68, 0.05)\\n            font-weight: 600;\\n        }\\n        \\n        .table td {\\n            padding:9ca3af;\\n        }\\n        \\n        .level-item p {\\n            color: #9ca3afpx;\\n            border-bottom: 1px solid #eee;\\n        }\\n        \\n        .table tr:hover {\\n            background: #f8f9ff;\\n        }rgba(239, 68, 68, 0.1);\\n            color: #fca5a5;\\n            padding: 15px;\\n            border-radius: 10px;\\n            display: none;\\n            border: 1px solid rgba(239, 68, 68, 0.3)bold;\\n        }\\n        \\n        .resistance {\\n            color: #d63031;\\n            font-weight: bold;\\n        }\\n        \\n        .level-item {\\n            background: #f8f9ff;\\n            border-radius: 8px;\\n            padding: 12px 15px;\\n            margin-bottom: 10px;\\n            border-left: 4px solid;\\n            transition: transform 0.2s;\\n        }\\n        \\n        .level-item:hover {\\n            transform: translateX(5px);\\n        }\\n        \\n        .level-item.support-item {\\n            border-left-color: #00b894;\\n        }\\n        \\n        .level-item.resistance-item {\\n            border-left-color: #d63031;\\n        }\\n        \\n        .level-strike {\\n            font-size: 1.3em;\\n            font-weight: bold;\\n            margin-bottom: 5px;\\n        }\\n        \\n        .level-details {\\n            font-size: 0.9em;\\n            color: #666;\\n        }\\n        \\n        .level-gamma {\\n            font-weight: bold;\\n            font-size: 1em;\\n            margin-top: 5px;\\n        }\\n        \\n        .error {\\n            background: #ff7675;\\n            color: white;\\n            padding: 15px;\\n            border-radius: 10px;\\n            display: none;\\n        }\\n    </style>\\n</head>\\n<body>\\n    <div class="container">\\n        <div class="header">\\n            <h1>ðŸ“Š ES Gamma Analyzer</h1>\\n            <p>Analisi 0DTE (0 Days To Expiration)</p>\\n        </div>\\n        \\n        <div class="upload-section">\\n            <div class="upload-area" id="uploadArea">\\n                <div class="upload-icon">ðŸ“„</div>\\n                <h3>Carica il file PDF con Open Interest Matrix</h3>\\n                <p style="color: #666; margin-top: 10px;">Clicca o trascina qui il file</p>\\n                <input type="file" id="fileInput" accept=".pdf">\\n            </div>\\n            \\n            <div class="price-input">\\n                <label for="currentPrice">Prezzo Corrente (opzionale):</label>\\n                <input type="number" id="currentPrice" placeholder="es. 6962.5" step="0.01">\\n            </div>\\n            \\n            <div style="text-align: center;">\\n                <button class="analyze-btn" id="analyzeBtn" disabled>Analizza</button>\\n            </div>\\n            \\n            <div class="error" id="errorMsg"></div>\\n            \\n            <div class="loading" id="loading">\\n                <div class="spinner"></div>\\n                <p style="margin-top: 15px; color: #667eea; font-weight: bold;">Analisi in corso...</p>\\n            </div>\\n        </div>\\n        \\n        <div class="results" id="results">\\n            <!-- Gamma Flip -->\\n            <div class="gamma-flip" id="gammaFlipCard">\\n                <div class="info-label">ðŸŽ¯ Gamma Flip Level (0DTE)</div>\\n                <div class="value" id="gammaFlipValue">-</div>\\n            </div>\\n            \\n            <!-- Regime -->\\n            <div class="card" id="regimeCard" style="display: none;">\\n                <h2>ðŸ“ˆ Regime di Mercato</h2>\\n                <div class="regime-box">\\n                    <div style="font-size: 1.2em; font-weight: bold; margin-bottom: 10px;" id="regimeType">-</div>\\n                    <div id="regimeStrategy">-</div>\\n                </div>\\n            </div>\\n            \\n            <!-- Livelli Chiave -->\\n            <div class="card">\\n                <h2>ðŸŽ¯ Livelli Chiave</h2>\\n                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px;">\\n                    <!-- Supporti -->\\n                    <div>\\n                        <h3 style="color: #00b894; margin-bottom: 15px;">ðŸ’ª Top 3 Supporti</h3>\\n                        <p style="color: #666; font-size: 0.9em; margin-bottom: 15px;">Sotto il prezzo (Call > Put)</p>\\n                        <div id="supportsContainer">\\n                            <p style="color: #999; text-align: center;">Nessun dato</p>\\n                        </div>\\n                        <p id="supportsNote" style="color: #ff9800; font-weight: bold; margin-top: 10px; display: none;"></p>\\n                    </div>\\n                    \\n                    <!-- Resistenze -->\\n                    <div>\\n                        <h3 style="color: #d63031; margin-bottom: 15px;">ðŸš§ Top 3 Resistenze</h3>\\n                        <p style="color: #666; font-size: 0.9em; margin-bottom: 15px;">Sopra il prezzo (Put > Call)</p>\\n                        <div id="resistancesContainer">\\n                            <p style="color: #999; text-align: center;">Nessun dato</p>\\n                        </div>\\n                        <p id="resistancesNote" style="color: #ff9800; font-weight: bold; margin-top: 10px; display: none;"></p>\\n                    </div>\\n                </div>\\n            </div>\\n            \\n            <!-- Statistiche -->\\n            <div class="card">\\n                <h2>ðŸ“Š Statistiche 0DTE</h2>\\n                <div class="info-grid" id="statsGrid">\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n    \\n    <script>\\n        let selectedFile = null;\\n        \\n        const uploadArea = document.getElementById(\\\'uploadArea\\\');\\n        const fileInput = document.getElementById(\\\'fileInput\\\');\\n        const analyzeBtn = document.getElementById(\\\'analyzeBtn\\\');\\n        const loading = document.getElementById(\\\'loading\\\');\\n        const results = document.getElementById(\\\'results\\\');\\n        const errorMsg = document.getElementById(\\\'errorMsg\\\');\\n        \\n        // Click per aprire file selector\\n        uploadArea.addEventListener(\\\'click\\\', () => fileInput.click());\\n        \\n        // File selection\\n        fileInput.addEventListener(\\\'change\\\', (e) => {\\n            selectedFile = e.target.files[0];\\n            if (selectedFile) {\\n                uploadArea.innerHTML = `\\n                    <div class="upload-icon">âœ…</div>\\n                    <h3>${selectedFile.name}</h3>\\n                    <p style="color: #666; margin-top: 10px;">Clicca per cambiare file</p>\\n                `;\\n                analyzeBtn.disabled = false;\\n            }\\n        });\\n        \\n        // Drag & Drop\\n        uploadArea.addEventListener(\\\'dragover\\\', (e) => {\\n            e.preventDefault();\\n            uploadArea.classList.add(\\\'dragover\\\');\\n        });\\n        \\n        uploadArea.addEventListener(\\\'dragleave\\\', () => {\\n            uploadArea.classList.remove(\\\'dragover\\\');\\n        });\\n        \\n        uploadArea.addEventListener(\\\'drop\\\', (e) => {\\n            e.preventDefault();\\n            uploadArea.classList.remove(\\\'dragover\\\');\\n            \\n            const files = e.dataTransfer.files;\\n            if (files.length > 0) {\\n                selectedFile = files[0];\\n                fileInput.files = files;\\n                uploadArea.innerHTML = `\\n                    <div class="upload-icon">âœ…</div>\\n                    <h3>${selectedFile.name}</h3>\\n                    <p style="color: #666; margin-top: 10px;">Clicca per cambiare file</p>\\n                `;\\n                analyzeBtn.disabled = false;\\n            }\\n        });\\n        \\n        // Analyze\\n        analyzeBtn.addEventListener(\\\'click\\\', async () => {\\n            if (!selectedFile) return;\\n            \\n            const formData = new FormData();\\n            formData.append(\\\'file\\\', selectedFile);\\n            \\n            const currentPrice = document.getElementById(\\\'currentPrice\\\').value;\\n            if (currentPrice) {\\n                formData.append(\\\'current_price\\\', currentPrice);\\n            }\\n            \\n            // Mostra loading\\n            loading.style.display = \\\'block\\\';\\n            results.style.display = \\\'none\\\';\\n            errorMsg.style.display = \\\'none\\\';\\n            analyzeBtn.disabled = true;\\n            \\n            try {\\n                const response = await fetch(\\\'/analyze\\\', {\\n                    method: \\\'POST\\\',\\n                    body: formData\\n                });\\n                \\n                const data = await response.json();\\n                \\n                if (data.error) {\\n                    throw new Error(data.error);\\n                }\\n                \\n                displayResults(data);\\n                results.style.display = \\\'block\\\';\\n                \\n            } catch (error) {\\n                errorMsg.textContent = \\\'âŒ \\\' + error.message;\\n                errorMsg.style.display = \\\'block\\\';\\n            } finally {\\n                loading.style.display = \\\'none\\\';\\n                analyzeBtn.disabled = false;\\n            }\\n        });\\n        \\n        function displayResults(data) {\\n            // Gamma Flip\\n            document.getElementById(\\\'gammaFlipValue\\\').textContent = \\n                data.gamma_flip ? data.gamma_flip.toFixed(2) : \\\'N/A\\\';\\n            \\n            // Regime\\n            if (data.regime) {\\n                document.getElementById(\\\'regimeCard\\\').style.display = \\\'block\\\';\\n                document.getElementById(\\\'regimeType\\\').textContent = data.regime;\\n                document.getElementById(\\\'regimeStrategy\\\').textContent = \\\'ðŸ“Œ \\\' + data.strategy;\\n            }\\n            \\n            if (data.supports && data.supports.length > 0) {\\n                supportsContainer.innerHTML = data.supports.map((s, i) => `\\n                    <div class="level-item support-item">\\n                        <div class="d-flex justify-content-between align-items-center">\\n                            <div>\\n                                <div class="level-strike text-support">S${i+1}  ${s.strike.toFixed(2)}</div>\\n                                <div class="level-details">Call: ${s.call_oi.toLocaleString()} | Put: ${s.put_oi.toLocaleString()}</div>\\n                            </div>\\n                            <div class="level-gamma text-support">+${(s.gamma / 1000).toFixed(0)}K</div>\\n                        </div>\\n                    </div>\\n                `).join(\\\'\\\');\\n                \\n                if (data.supports_note) {\\n                    supportsNote.innerHTML = \\\'<i class="bi bi-exclamation-triangle me-2"></i>\\\' + data.supports_note;\\n                    supportsNote.style.display = \\\'block\\\';\\n                } else {\\n                    supportsNote.style.display = \\\'none\\\';\\n                }\\n            } else {\\n                supportsContainer.innerHTML = \\\'<p class="text-muted text-center py-4">No support below price</p>\\\';\\n                supportsNote.style.display = \\\'none\\\';\\n            }\\n            \\n            // Resistenze\\n            const resistancesContainer = document.getElementById(\\\'resistancesContainer\\\');\\n            const resistancesNote = document.getElementById(\\\'resistancesNote\\\');\\n            if (data.resistances && data.resistances.length > 0) {\\n                resistancesContainer.innerHTML = data.resistances.map((r, i) => `\\n                    <div class="level-item resistance-item">\\n                        <div class="d-flex justify-content-between align-items-center">\\n                            <div>\\n                                <div class="level-strike text-resistance">R${i+1}  ${r.strike.toFixed(2)}</div>\\n                                <div class="level-details">Call: ${r.call_oi.toLocaleString()} | Put: ${r.put_oi.toLocaleString()}</div>\\n                            </div>\\n                            <div class="level-gamma text-resistance">${(r.gamma / 1000).toFixed(0)}K</div>\\n                        </div>\\n                    </div>\\n                `).join(\\\'\\\');\\n                \\n                if (data.resistances_note) {\\n                    resistancesNote.innerHTML = \\\'<i class="bi bi-exclamation-triangle me-2"></i>\\\' + data.resistances_note;\\n                    resistancesNote.style.display = \\\'block\\\';\\n                } else {\\n                    resistancesNote.style.display = \\\'none\\\';\\n                }\\n            } else {\\n                resistancesContainer.innerHTML = \\\'<p class="text-muted text-center py-4">No resistance above price</p>\\\';\\n                resistancesNote.style.display = \\\'none\\\';\\n            }\\n            \\n            // Statistiche\\n            const statsGrid = document.getElementById(\\\'statsGrid\\\');\\n            const stats = data.stats;\\n            statsGrid.innerHTML = `\\n                <div class="col-md-4">\\n                    <div class="stat-card p-3">\\n                        <div class="stat-label mb-2">Strike Prices</div>\\n                        <div class="stat-value">${stats.total_strikes}</div>\\n                    </div>\\n                </div>\\n                <div class="col-md-4">\\n                    <div class="stat-card p-3">\\n                        <div class="stat-label mb-2">Range</div>\\n                        <div class="stat-value" style="font-size: 1.3em;">${stats.strike_range}</div>\\n                    </div>\\n                </div>\\n                <div class="col-md-4">\\n                    <div class="stat-card p-3">\\n                        <div class="stat-label mb-2">Total Call OI</div>\\n                        <div class="stat-value">${stats.total_call_oi.toLocaleString()}</div>\\n                    </div>\\n                </div>\\n                <div class="col-md-4">\\n                    <div class="stat-card p-3">\\n                        <div class="stat-label mb-2">Total Put OI</div>\\n                        <div class="stat-value">${stats.total_put_oi.toLocaleString()}</div>\\n                    </div>\\n                </div>\\n                <div class="col-md-4">\\n                    <div class="stat-card p-3">\\n                        <div class="stat-label mb-2">Put/Call Ratio</div>\\n                        <div class="stat-value">${stats.put_call_ratio ? stats.put_call_ratio : \\\'N/A\\\'}</div>\\n                    </div>\\n                </div>\\n            `;\\n            \\n            if (data.current_price) {\\n                statsGrid.innerHTML += `\\n                    <div class="col-md-4">\\n                        <div class="stat-card p-3" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%); border-left-color: #8b5cf6;">\\n                            <div class="stat-label mb-2">Current Price</div>\\n                            <div class="stat-value">${data.current_price}</div>\\n                        </div>\\n                    </div>\\n                `;\\n            }\\n        }\\n    </script>\\n</body>\\n</html>\'\n\nblocks = {}\ndebug_info = \'\''

blocks = {}
debug_info = ''